knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = TRUE
)
require("ggplot2")
require("dplyr")
require("reshape2")
require("MASS")
require("pscl")
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = TRUE
)
require("ggplot2")
require("dplyr")
require("reshape2")
require("MASS")
require("pscl")
## for Ravlt data
dat <- read.csv("./data/connectivity_ravlt.csv")
# modify columns if needed
datRavlt <- data.frame("subj_id"= dat$src_subject_id)
datRavlt$age <- dat$interview_age/12
datRavlt$sex_F <- ifelse(dat$sex == "F",1,0)
datRavlt$sexAge <- datRavlt$sex_F * datRavlt$age
datRavlt$'RAVLT_Sum_of_Trials_1_5' = dat$ravlt_L
datRavlt$'RAVLT_Immediate_Recall' = dat$trial6
datRavlt$'Left_PCC_Left_AG_Connectivity' = dat$ROI28_Langulargyrus
datRavlt$'Left_PCC_Left_PHG_Connectivity' = dat$ROI9_Lmesialtemporal
# drop NA
datRavlt <- datRavlt[complete.cases(datRavlt),]
## for Neuroticism data
dat <- read.csv("./data/connectivity_personality_emotion.csv")
# modify columns if needed
datNeuro <- data.frame("subj_id"= dat$src_subject_id)
datNeuro$age <- dat$interview_age/12
datNeuro$sex_F <- ifelse(dat$sex == "F",1,0)
datNeuro$sexAge <- datNeuro$sex_F * datNeuro$age
datNeuro$'Neuroticism' = dat$Neuroticism
datNeuro$'Left_PCC_Right_STS_Connectivity' = dat$ROI17_Rsuperiortemporal
datNeuro$'Left_PCC_Left_Insula_Connectivity' = dat$ROI7_Linsula
# drop NA
datNeuro <- datNeuro[complete.cases(datNeuro),]
dat4model <- datRavlt
col_y <- c("RAVLT_Sum_of_Trials_1_5")
col_x <- c("sex_F","age","sexAge",
"Left_PCC_Left_AG_Connectivity",
"Left_PCC_Left_PHG_Connectivity")
cat("The summary stats is: \n")
summary(dat4model[,col_y])
cat("The response variance is: ", var(dat4model[,col_y]))
myFormula <- paste(col_y, paste(col_x, collapse=" + "), sep="~")
myFormula <- as.formula(myFormula)
summary(mPoisson <- glm(myFormula,
family=poisson,
data = dat4model))
summary(mNB <- glm.nb(myFormula,
data = dat4model))
myFormula <- paste(col_y, paste(col_x, collapse=" + "), sep="~")
myFormula <- as.formula(myFormula)
summary(mQPoisson <- glm(myFormula,
family=quasipoisson,
data = dat4model))
dat4Plot <- data.frame("True" = dat4model[,col_y])
dat4Plot$predPoi <- predict(mPoisson, newdata = dat4model, type = "response")
dat4Plot$predQPoi <- predict(mQPoisson, newdata = dat4model, type = "response")
dat4Plot$predNB <- predict(mNB, newdata = dat4model, type = "response")
dat4Plot$id <- dat4model$subj_id
#dat4Plot <- melt(dat4Plot,id.vars = id)
dat4Plot[1:20,]
col_y <- c("RAVLT_Sum_of_Trials_1_5")
col_x <- c("sex_F",
"Left_PCC_Left_AG_Connectivity")
myFormula2 <- paste(paste(col_y, paste(col_x, collapse=" + "), sep="~"), "+ offset(log(age))")
myFormula2 <- as.formula(myFormula2)
summary(mNB2 <- glm.nb(myFormula2,data = dat4model))
# age group 36-39, 40-49, etc
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = TRUE
)
require("ggplot2")
require("dplyr")
require("reshape2")
require("MASS")
require("pscl")
## for Ravlt data
dat <- read.csv("./data/connectivity_ravlt.csv")
# modify columns if needed
datRavlt <- data.frame("subj_id"= dat$src_subject_id)
datRavlt$age <- dat$interview_age/12
datRavlt$sex_F <- ifelse(dat$sex == "F",1,0)
datRavlt$sexAge <- datRavlt$sex_F * datRavlt$age
datRavlt$'RAVLT_Sum_of_Trials_1_5' = dat$ravlt_L
datRavlt$'RAVLT_Immediate_Recall' = dat$trial6
datRavlt$'Left_PCC_Left_AG_Connectivity' = dat$ROI28_Langulargyrus
datRavlt$'Left_PCC_Left_PHG_Connectivity' = dat$ROI9_Lmesialtemporal
# drop NA
datRavlt <- datRavlt[complete.cases(datRavlt),]
## for Neuroticism data
dat <- read.csv("./data/connectivity_personality_emotion.csv")
# modify columns if needed
datNeuro <- data.frame("subj_id"= dat$src_subject_id)
datNeuro$age <- dat$interview_age/12
datNeuro$sex_F <- ifelse(dat$sex == "F",1,0)
datNeuro$sexAge <- datNeuro$sex_F * datNeuro$age
datNeuro$'Neuroticism' = dat$Neuroticism
datNeuro$'Left_PCC_Right_STS_Connectivity' = dat$ROI17_Rsuperiortemporal
datNeuro$'Left_PCC_Left_Insula_Connectivity' = dat$ROI7_Linsula
# drop NA
datNeuro <- datNeuro[complete.cases(datNeuro),]
dat4model <- datRavlt
col_y <- c("RAVLT_Sum_of_Trials_1_5")
col_x <- c("sex_F","age","sexAge",
"Left_PCC_Left_AG_Connectivity")
cat("The summary stats is: \n")
summary(dat4model[,col_y])
cat("The response variance is: ", var(dat4model[,col_y]))
myFormula <- paste(col_y, paste(col_x, collapse=" + "), sep="~")
myFormula <- as.formula(myFormula)
summary(mPoisson <- glm(myFormula,
family=poisson,
data = dat4model))
summary(mNB <- glm.nb(myFormula,
data = dat4model))
myFormula <- paste(col_y, paste(col_x, collapse=" + "), sep="~")
myFormula <- as.formula(myFormula)
summary(mQPoisson <- glm(myFormula,
family=quasipoisson,
data = dat4model))
dat4Plot <- data.frame("True" = dat4model[,col_y])
dat4Plot$predPoi <- predict(mPoisson, newdata = dat4model, type = "response")
dat4Plot$predQPoi <- predict(mQPoisson, newdata = dat4model, type = "response")
dat4Plot$predNB <- predict(mNB, newdata = dat4model, type = "response")
dat4Plot$id <- dat4model$subj_id
#dat4Plot <- melt(dat4Plot,id.vars = id)
dat4Plot[1:20,]
col_y <- c("RAVLT_Sum_of_Trials_1_5")
col_x <- c("sex_F",
"Left_PCC_Left_AG_Connectivity")
myFormula2 <- paste(paste(col_y, paste(col_x, collapse=" + "), sep="~"), "+ offset(log(age))")
myFormula2 <- as.formula(myFormula2)
summary(mNB2 <- glm.nb(myFormula2,data = dat4model))
# age group 36-39, 40-49, etc
dat4model$agegroup <- cut(dat4model$age,
breaks=c(30,39,49,59,69,79,89,100),
labels=c('36_39','40_49','50_59','60_69','70_79',
'80_89','90_100'))
col_y <- c("RAVLT_Sum_of_Trials_1_5")
col_x <- c("sex_F","agegroup",
"Left_PCC_Left_AG_Connectivity")
myFormula3 <- paste(paste(col_y, paste(col_x, collapse=" + "), sep="~"))
myFormula3 <- as.formula(myFormula3)
summary(mNB3 <- glm.nb(myFormula2,data = dat4model))
